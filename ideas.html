<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Initiative</title>
</head>
<body>

<div class="container mt-5">
  <h1 class="mb-4">Community Initiative</h1>

  <!-- Idea Submission Form -->
  <form id="ideaForm">
    <div class="form-group">
      <label for="ideaInput">Submit your idea:</label>
      <input type="text" class="form-control" id="ideaInput" placeholder="Enter your idea">
    </div>
    <button type="submit">Submit</button>
  </form>
</div>

<footer class="footer mt-5">
  <div class="container">
    <p>Version 1.0</p>
  </div>
</footer>

<script type="module">
  // Firebase configuration
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
  import { getAuth } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";
  import { getDatabase } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDn0L5eNhnsCkoNIl1xqXC1vAc9RgD3fxQ",
    authDomain: "camaswalkcommunity-e51e0.firebaseapp.com",
    projectId: "camaswalkcommunity-e51e0",
    storageBucket: "camaswalkcommunity-e51e0.appspot.com",
    messagingSenderId: "761814884837",
    appId: "1:761814884837:web:833d652b181df6e118cf0c",
    measurementId: "G-XQ35VWDWFD"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const database = getDatabase(app);

  // Function to save an idea to Firebase Realtime Database
  function saveIdeaToFirebase(ideaText, displayName) {
    const newIdeaRef = database.ref('ideas').push(); // Create a new unique reference for the idea
    newIdeaRef.set({
      text: ideaText,
      displayName: displayName,
      votes: 0
    });
  }

  // Function to handle idea submission
  document.getElementById('ideaForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent form submission

    const ideaText = document.getElementById('ideaInput').value.trim(); // Get idea text
    if (ideaText !== '') {
      // Get the currently authenticated user
      const user = auth.currentUser;

      if (user) {
        // User is signed in, get the display name
        const displayName = user.displayName;
        saveIdeaToFirebase(ideaText, displayName); // Save idea to Firebase with display name
      } else {
        // No user is signed in, handle this case as per your requirement
        console.log("No user signed in.");
      }

      document.getElementById('ideaInput').value = ''; // Clear input field
    }
  });
</script>

</body>
</html>
